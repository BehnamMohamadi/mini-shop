<!DOCTYPE html>
<html lang="fa" dir="rtl">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>سبد خرید - فروشگاه فلان</title>
  <link href="https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="/stylesheet/basket-page.css">
</head>

<body>
  <!-- Header -->
  <header class="basket-header">
    <div class="header-content">
      <div class="header-right">
        <a href="/shop" class="back-to-shop">
          <i class="bx bx-arrow-right"></i>
          بازگشت به فروشگاه
        </a>
        <h1 class="page-title">مدیریت سبد خرید</h1>
      </div>
      <div class="header-left">
        <div class="user-info">
          <% if (user) { %>
            <span class="user-name">
              <%= user.firstname %>
                <%= user.lastname %>
            </span>
            <i class="bx bx-user-circle"></i>
            <% } %>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="basket-main">
    <div class="container">
      <!-- Basket Status Section -->
      <div class="basket-status-card">
        <div class="status-header">
          <h2><i class="bx bx-shopping-bag"></i> وضعیت سبد خرید</h2>
          <div class="status-badge" id="status-badge">در حال بارگذاری...</div>
        </div>
        <div class="status-info" id="status-info">
          <div class="info-item">
            <span class="label">تعداد کل اقلام:</span>
            <span class="value" id="total-items">0</span>
          </div>
          <div class="info-item">
            <span class="label">مجموع مبلغ:</span>
            <span class="value" id="total-price">۰ تومان</span>
          </div>
        </div>
      </div>

      <!-- Basket Items Section -->
      <div class="basket-items-section">
        <div class="section-header">
          <h3><i class="bx bx-list-ul"></i> اقلام سبد خرید</h3>
          <button class="refresh-btn" id="refresh-btn">
            <i class="bx bx-refresh"></i> بروزرسانی
          </button>
        </div>
        <div class="basket-items" id="basket-items">
          <!-- Items will be loaded here -->
          <div class="loading-state">
            <i class="bx bx-loader-alt"></i>
            <span>در حال بارگذاری اقلام...</span>
          </div>
        </div>
      </div>

      <!-- Action Buttons Section -->
      <div class="basket-actions-section">
        <div class="actions-card">
          <div class="actions-header">
            <h3><i class="bx bx-cog"></i> عملیات سبد</h3>
          </div>
          <div class="actions-content" id="actions-content">
            <!-- Actions will be populated based on status -->
          </div>
        </div>
      </div>

      <!-- Order History Section -->
      <div class="history-section">
        <div class="section-header">
          <h3><i class="bx bx-history"></i> سوابق سفارشات</h3>
          <button class="toggle-history-btn" id="toggle-history-btn">
            <i class="bx bx-chevron-down"></i> نمایش سوابق
          </button>
        </div>
        <div class="history-content hidden" id="history-content">
          <!-- History will be loaded here -->
        </div>
      </div>
    </div>
  </main>

  <!-- Payment Modal -->
  <div id="payment-modal" class="modal hidden">
    <div class="modal-overlay"></div>
    <div class="modal-content">
      <div class="modal-header">
        <h3><i class="bx bx-credit-card"></i> پرداخت سفارش</h3>
        <button class="modal-close" id="close-payment-modal">
          <i class="bx bx-x"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="payment-summary">
          <h4>خلاصه سفارش</h4>
          <div class="summary-items" id="payment-summary-items">
            <!-- Payment summary will be populated here -->
          </div>
          <div class="summary-total">
            <strong>مجموع نهایی: <span id="payment-total">۰ تومان</span></strong>
          </div>
        </div>
        <div class="payment-methods">
          <h4>روش پرداخت</h4>
          <div class="payment-options">
            <label class="payment-option">
              <input type="radio" name="payment-method" value="online" checked>
              <span class="option-icon"><i class="bx bx-credit-card"></i></span>
              <span class="option-text">پرداخت آنلاین</span>
            </label>
            <label class="payment-option">
              <input type="radio" name="payment-method" value="cash">
              <span class="option-icon"><i class="bx bx-money"></i></span>
              <span class="option-text">پرداخت نقدی</span>
            </label>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary" id="cancel-payment">انصراف</button>
        <button class="btn-primary" id="confirm-payment">
          <i class="bx bx-check"></i> تأیید و پرداخت
        </button>
      </div>
    </div>
  </div>

  <!-- Notification Container -->
  <div id="notification-container"></div>

  <!-- Scripts -->
  <script type="module" src="/javascript/basket-page.js"></script>
</body>

</html>